<div class="appt-wrapper" dir="rtl">
  <!-- בחירת ילד + אישורים -->
  <div class="appt-card">
    <h2>זימון תורים</h2>

    <div class="appt-header-row">

      <!-- טור ימין: בחירת ילד -->
      <div class="appt-field-group child-group">
        <span class="appt-field-label">ילד/ה</span>

        <mat-select #childSelect class="appt-select" [(ngModel)]="selectedChildId" (selectionChange)="onChildChange()"
        [disabled]="childrenLoading || !children.length"
   placeholder="בחר/י ילד">
          <!-- שורת חיפוש -->
          <mat-option class="search-option" (click)="$event.stopPropagation()" (mousedown)="$event.stopPropagation()">
            <input matInput type="text" placeholder="חיפוש לפי שם ילד/ה..." [(ngModel)]="childSearchTerm"
              (ngModelChange)="filterChildren()" (keydown.enter)="selectFirstChildFromSearch($event)"
              (click)="$event.stopPropagation()" class="search-input" />
          </mat-option>

          <!-- אופציות -->
          <mat-option *ngFor="let child of filteredChildren" [value]="child.child_uuid">
            {{ child.first_name }} {{ child.last_name }}
          </mat-option>
        </mat-select>

      </div>

      <div class="appt-field-group instructor-group">
        <span class="appt-field-label">מדריך</span>
<div
  class="field-wrap"
  [class.is-disabled]="!selectedChildId"
  (click)="!selectedChildId && showUiHint('instructor', missingInstructorMsg)"
>
        <mat-select #instructorSelect class="appt-select" [ngClass]="{ disabled: !selectedChildId }"
          [(ngModel)]="selectedInstructorId" (selectionChange)="onInstructorChange()" [disabled]="!selectedChildId"
          placeholder="בחר/י מדריך">
          <!-- שורת חיפוש -->
          <mat-option class="search-option" (click)="$event.stopPropagation()" (mousedown)="$event.stopPropagation()">
            <input matInput type="text" placeholder="חיפוש לפי שם מדריך..." [(ngModel)]="instructorSearchTerm"
              (ngModelChange)="filterInstructors()" (keydown.enter)="selectFirstInstructorFromSearch($event)"
              (click)="$event.stopPropagation()" class="search-input" />
          </mat-option>

          <!-- אופציה של "כל המדריכים" -->
          <mat-option value="any">
            כל המדריכים
          </mat-option>

          <!-- אופציות – רשימה מסוננת -->
          <mat-option *ngFor="let ins of filteredInstructors" [value]="ins.instructor_uid">
            {{ ins.full_name }}
          </mat-option>
        </mat-select>
          <small class="hint" *ngIf="uiHint['instructor']">{{ uiHint['instructor'] }}</small>

      </div>


    </div>
  </div>

  <!-- כרטיס מידע על המדריך שנבחר -->
  <div *ngIf="selectedInstructor && !noInstructorPreference && showInstructorDetails" class="instructor-card">
    <!-- כפתור איקס לסגירה -->
    <button type="button" class="instructor-close" (click)="showInstructorDetails = false"
      aria-label="סגירת פרטי מדריך">
      ✕
    </button>

    <div class="instructor-card-header">
      <div class="instructor-name">
        {{ selectedInstructor.full_name }}
      </div>
    </div>

    <div class="instructor-card-body">
      <!-- עמודת מידע טקסטואלי -->
      <div class="instructor-info-col">
        <div class="instructor-line" *ngIf="selectedInstructor.gender">
          <span class="label">מין:</span>
          <span class="value">{{ selectedInstructor.gender }}</span>
        </div>
      </div>

     <div class="instructor-line" *ngIf="selectedInstructor.about">
  <span class="label">אודות:</span>
  <span class="value about-text">
    {{ selectedInstructor.about }}
  </span>
</div>



<div class="instructor-cert-col" *ngIf="selectedInstructor?.certificate?.trim() as cert">
  <div class="instructor-line">
    <span class="label">תעודה:</span>
    <span class="value">
      <a [href]="cert" target="_blank" rel="noopener noreferrer">
        <img [src]="cert" alt="תעודת מדריך" class="certificate-thumb" />
      </a>
    </span>
  </div>
</div>


    </div>

  </div>

 <div class="appt-tabs">

  <!-- Series -->
  <div class="tab-wrap" (click)="onTabClick('series')">
    <button
      type="button"
      class="appt-tab"
      [class.active]="selectedTab === 'series'"
      [class.tab-disabled]="tabsLocked"
      matTooltip="קביעת סדרת טיפולים קבועה באותו יום ושעה (למשל כל חמישי 16:00)"
      matTooltipPosition="above"
      matTooltipClass="custom-tooltip"
      [matTooltipDisabled]="tabsLocked"
    >
      סדרת טיפולים
    </button>
  </div>

  <!-- Makeup -->
  <div class="tab-wrap" (click)="onTabClick('makeup')">
    <button
      type="button"
      class="appt-tab"
      [class.active]="selectedTab === 'makeup'"
      [class.tab-disabled]="tabsLocked"
      matTooltip="מציאת חורים פנויים לשיעורי השלמה על חשבון שיעורים שבוטלו לפי הגדרות החווה"
      matTooltipPosition="above"
      matTooltipClass="custom-tooltip"
      [matTooltipDisabled]="tabsLocked"
    >
      שיעור השלמה
    </button>
  </div>

  <!-- Occupancy -->
  <div class="tab-wrap" (click)="onTabClick('occupancy')">
    <button
      type="button"
      class="appt-tab"
      [class.active]="selectedTab === 'occupancy'"
      [class.tab-disabled]="tabsLocked"
      matTooltip="שיעורים שבוטלו על ידי מדריך וזמינים למילוי מקום"
      matTooltipPosition="above"
      matTooltipClass="custom-tooltip"
      [matTooltipDisabled]="tabsLocked"
    >
      מילוי מקום
    </button>
  </div>

</div>

<!-- הודעה רק אחרי ניסיון לחיצה על טאבים נעולים -->
<small class="hint" *ngIf="uiHint['tab']">{{ uiHint['tab'] }}</small>

</div>


<!-- דיאלוג סדרה - מזכירה (עם דילוגים) -->
<ng-template #confirmSeriesDialogSecretary let-dialogRef="dialogRef">
  <div dir="rtl" style="padding: 10px; max-width: 350px;">
    <h3>אישור בקשת סדרה</h3>

    סדרה שמתחילה בתאריך
    <b><span class="ltr">{{ seriesConfirmData.startDate | date:'dd-MM-yyyy'}}</span></b><br>

    <ng-container *ngIf="!isOpenEndedSeries">
      מסתיימת בתאריך
      <b><span class="ltr">{{ seriesConfirmData.endDate | date:'dd-MM-yyyy'}}</span></b><br>
    </ng-container>

    ביום <b>{{ seriesConfirmData.dayLabel }}</b><br>

    בשעה
    <b><span class="ltr time-range">{{ seriesConfirmData.startTime }}–{{ seriesConfirmData.endTime }}</span></b>

    <!-- פירוט דילוגים בסדרה -->
    <div
      style="margin-top:12px"
      *ngIf="seriesConfirmData.skippedFarm.length || seriesConfirmData.skippedInstructor.length"
    >
      <div style="font-weight:700; margin-bottom:6px;">
        דילוגים בסדרה:
      </div>

      <!-- ימי חופש חווה -->
      <div *ngIf="seriesConfirmData.skippedFarm.length">
        <div style="font-weight:600;">ימי חופש חווה:</div>
        <ul style="margin:6px 18px;">
          <li *ngFor="let d of seriesConfirmData.skippedFarm">{{ d }}</li>
        </ul>
      </div>

      <!-- אי זמינות מדריך -->
      <div *ngIf="seriesConfirmData.skippedInstructor.length">
        <div style="font-weight:600;">אי זמינות מדריך:</div>
        <ul style="margin:6px 18px;">
          <li *ngFor="let d of seriesConfirmData.skippedInstructor">{{ d }}</li>
        </ul>
      </div>
    </div>

    <div style="display:flex; justify-content:flex-end; gap:12px; margin-top:20px;">
      <button class="btn-cancel" (click)="dialogRef.close(false)">לא</button>
      <button class="btn-ok" (click)="dialogRef.close(true)">כן</button>
    </div>
  </div>
</ng-template>


<!-- דיאלוג סדרה - הורה (בלי דילוגים) -->
<ng-template #confirmSeriesDialogParent let-dialogRef="dialogRef">
  <div dir="rtl" style="padding: 10px; max-width: 350px;">
    <h3>אישור הזמנת סדרה</h3>

    האם אתה בטוח שברצונך להזמין סדרה שמתחילה בתאריך
<b><span class="ltr">{{ seriesConfirmData.startDate | date:'dd-MM-yyyy' }}</span></b>

    <ng-container *ngIf="!isOpenEndedSeries">
      ומסתיימת בתאריך
      <b><span class="ltr">{{ seriesConfirmData.endDate | date:'dd-MM-yyyy'}}</span></b>
    </ng-container>

    <br />

    בשעות
    <b><span class="ltr time-range">{{ seriesConfirmData.startTime }}–{{ seriesConfirmData.endTime }}</span></b>

    בימי <b>{{ seriesConfirmData.dayLabel }}</b>

    <ng-container *ngIf="seriesConfirmData.instructorName">
      <br />
      עם המדריך/ה <b>{{ seriesConfirmData.instructorName }}</b>
    </ng-container>

    <div style="display:flex; justify-content:flex-end; gap:12px; margin-top:20px;">
      <button class="btn-cancel" (click)="dialogRef.close(false)">לא</button>
      <button class="btn-ok" (click)="dialogRef.close(true)">כן</button>
    </div>
  </div>
</ng-template>
<div *ngIf="selectedTab === 'series'" class="appt-card">

    <div class="appt-form-row">
     <div class="appt-field-group">
  <span class="appt-field-label">כמות שיעורים בסדרה</span>

  <div
    class="field-wrap"
    [class.is-disabled]="!canChooseSeriesCount || isOpenEndedSeries"
    (click)="(!canChooseSeriesCount || isOpenEndedSeries) && showUiHint('seriesCount', isOpenEndedSeries ? 'מסומן ללא הגבלה – אין צורך לבחור כמות' : missingSeriesCountMsg)"
  >
    <select
      class="appt-select"
      [(ngModel)]="seriesLessonCount"
      (ngModelChange)="onSeriesLessonCountChange($event)"
      [disabled]="!canChooseSeriesCount || isOpenEndedSeries"
    >
      <option [ngValue]="null" disabled hidden>
        בחר/י כמות מפגשים
      </option>

      <option *ngFor="let n of seriesLessonCountOptions" [ngValue]="n">
        {{ n }} מפגשים
      </option>
    </select>

    <small class="hint" *ngIf="uiHint['seriesCount']">{{ uiHint['seriesCount'] }}</small>
  </div>

  <!-- שורה של "ללא הגבלה" -->
  <label class="unlimited-row">
    <input
      type="checkbox"
      [(ngModel)]="isOpenEndedSeries"
      (change)="onUnlimitedSeriesToggle()"
    />
    סדרה ללא הגבלת שיעורים
  </label>
</div>

<!-- מסלול תשלום -->
<div class="appt-field-group">
  <span class="appt-field-label">מסלול תשלום</span>

  <div
    class="field-wrap"
    [class.is-disabled]="paymentLocked"
    (click)="paymentLocked && showUiHint('payment', missingPaymentPlanMsg)"
  >
    <select
  class="appt-select"
  [(ngModel)]="selectedPaymentPlanId"
  (ngModelChange)="onPaymentPlanChange($event)"
>

      <option [ngValue]="null" disabled hidden>
        בחר/י מסלול תשלום
      </option>

      <option *ngFor="let plan of paymentPlans" [ngValue]="plan.id">
        {{ plan.name }}
        <ng-container *ngIf="plan.customer_amount != null">
          – {{ plan.customer_amount | number:'1.0-0' }} ₪ לשיעור
        </ng-container>
      </option>
    </select>

    <small class="hint" *ngIf="uiHint['payment']">{{ uiHint['payment'] }}</small>

    <small
      *ngIf="selectedPaymentPlan?.require_docs_at_booking"
      style="color:#888; display:block; margin-top:4px;"
    >
      למסלול זה נדרשים מסמכים:
      {{ selectedPaymentPlan?.required_docs?.join(', ') || 'ע״פ הנחיות החווה' }}
    </small>
  </div>
</div>

<!-- העלאת מסמך רק אם המסלול דורש -->
<div class="appt-form-row" *ngIf="selectedPaymentPlan?.require_docs_at_booking">
  <div class="appt-field-group">
    <span class="appt-field-label">העלאת מסמך למסלול</span>
    <input type="file" class="appt-input" (change)="onReferralFileSelected($event)" accept=".pdf,image/*" />
    <div *ngIf="referralFile" class="file-name">
      הקובץ שנבחר: <b>{{ referralFile.name }}</b>
    </div>
    <p class="error" *ngIf="referralUploadError">{{ referralUploadError }}</p>
  </div>
</div>

    <div class="appt-form-row">
      <div class="appt-field-group">
        <span class="appt-field-label">יום תחילת סדרה בשבוע</span>

          <!-- פריסה דו-עמודתית: ימין קלנדר, שמאל שעות -->
<div class="series-layout" *ngIf="canShowSeriesCalendar; else seriesCalendarLocked">
            <!-- קלנדר קטן לחיפוש סדרות -->
            <div class="series-calendar">
              <div class="calendar-header">
                <button type="button" (click)="goToPrevMonth()">&lt;</button>
                <span>
                  {{ currentCalendarMonth + 1 }}/{{ currentCalendarYear }}
                </span>
                <button type="button" (click)="goToNextMonth()">&gt;</button>
              </div>

              <div class="calendar-grid">
                <!-- כותרות ימים -->
                <div class="calendar-day-name">א'</div>
                <div class="calendar-day-name">ב'</div>
                <div class="calendar-day-name">ג'</div>
                <div class="calendar-day-name">ד'</div>
                <div class="calendar-day-name">ה'</div>
                <div class="calendar-day-name">ו'</div>
                <div class="calendar-day-name">ש'</div>

                <!-- הימים עצמם -->
                <div *ngFor="let d of seriesCalendarDays" class="calendar-day" [ngClass]="{
              'not-current': !d.isCurrentMonth,
              'has-slots': d.hasSlots,
              'selected-day': d.date === selectedSeriesDate
            }" (click)="onSeriesCalendarDayClick(d)">
                  <span class="day-label" *ngIf="d.label">{{ d.label }}</span>
                  <span class="day-dot" *ngIf="d.hasSlots"></span>
                </div>
              </div>
            </div>

            <!-- שעות זמינות ביום שנבחר -->
            <div class="slots-list series-slots" *ngIf="selectedSeriesDate && selectedSeriesDaySlots.length">
              <h4>שעות זמינות ליום {{ selectedSeriesDate }} להתחלת סדרה</h4>

              <table>
                <thead>
                  <tr>
                    <th>שעה</th>
                    <th>מדריך</th>
                    <th>סוג שיעור</th>
                    <th></th>
                  </tr>
                </thead>
                <tbody>
                  <tr *ngFor="let s of selectedSeriesDaySlots">
<td>
  <span class="time-range">
    {{ s.start_time | slice:0:5 }}–{{ s.end_time | slice:0:5 }}
  </span>
</td>
                    <td>{{ s.instructor_name || s.instructor_id }}</td>
<td>{{ s.riding_type_name || '—' }}</td>

                    <td>
               <span
          class="tooltip-wrap"
          [matTooltip]="getSeriesDisabledTooltip(s)"
          matTooltipPosition="above"
          [matTooltipDisabled]="!isSeriesDisabled(s)"
        >
          <button
            type="button"
            class="appt-cta"
            (click)="onSeriesSlotChosen(s)"
            [disabled]="isSeriesDisabled(s)"
            [attr.aria-disabled]="isSeriesDisabled(s) ? 'true' : null"
          >
            בקש סדרה במועד זה
          </button>
        </span>



                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

          </div> <!-- /series-layout -->
          <ng-template #seriesCalendarLocked>
  <div class="empty-text" style="margin-top:10px;">
    כדי לראות זמינות – בחרי כמות שיעורים בסדרה או סמני “סדרה ללא הגבלת שיעורים”.
  </div>
</ng-template>

        </div>
      </div>

    </div>


    <p class="error" *ngIf="seriesError">{{ seriesError }}</p>
    <p class="success" *ngIf="seriesCreatedMessage">
      {{ seriesCreatedMessage }}
    </p>

  </div>

</div>

<!-- ======== טאב: מילוי מקום ======== -->
<div *ngIf="selectedTab === 'occupancy'" class="appt-card">
  <h3>שיעורים שמחפשים מילוי מקום</h3>

  <div class="slots-list">
    <ng-container *ngIf="loadingOccupancyCandidates">
      <p>טוען שיעורים שמחפשים מילוי מקום...</p>
    </ng-container>

    <ng-container *ngIf="!loadingOccupancyCandidates && occupancyCandidates.length > 0">
      <table class="appt-table occupancy-table">
  <thead>
    <tr>
      <th>תאריך</th>
      <th>יום</th>
      <th>שעה</th>
      <th>מדריך</th>
      <!-- <th>סטטוס</th> -->
      <th></th>
    </tr>
  </thead>

  <tbody>
    <tr
      *ngFor="let o of occupancyCandidates"
      [ngClass]="{
        'occupancy-row-selected':
          selectedOccupancyCandidate?.lesson_id === o.lesson_id &&
          selectedOccupancyCandidate?.occur_date === o.occur_date
      }"
    >
      <td>{{ o.occur_date }}</td>
<td>{{ getSlotDayLabel(o.occur_date) }}</td>
<td>
  <span class="time-range">
    {{ o.start_time | slice:0:5 }}–{{ o.end_time | slice:0:5 }}
  </span>
</td>
      <td>{{ o.instructor_name || o.instructor_id }}</td>
      <!-- <td>{{ o.status }}</td> -->
      <td>
        <button
          type="button"
          class="appt-cta"
          (click)="openOccupancySlotsForCandidate(o)"
        >
          להשלמת שיעור זה
        </button>
      </td>
    </tr>
  </tbody>
</table>

    </ng-container>

    <p
      class="empty-text"
      *ngIf="!loadingOccupancyCandidates && !occupancyCandidates.length"
    >
      אין כרגע שיעורים שמחפשים מילוי מקום.
    </p>
  </div>
</div>
<div class="slots-list occupancy-slots"
     *ngIf="selectedTab === 'occupancy' && selectedOccupancyCandidate">
  <h4>
    שיעורים זמינים למילוי מקום עבור
    {{ selectedOccupancyCandidate.occur_date }}
  </h4>

  <table *ngIf="occupancySlots.length > 0">
    <thead>
      <tr>
        <th>תאריך</th>
        <th>יום</th>
        <th>שעה</th>
        <th>מדריך</th>
        <th>סוג שיעור</th>
        <th></th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let s of occupancySlots">
        <td>{{ s.occur_date }}</td>
        <td>{{ getSlotDayLabel(s.occur_date) }}</td>
<td>
  <span class="time-range">
    {{ s.start_time | slice:0:5 }}–{{ s.end_time | slice:0:5 }}
  </span>
</td>
        <td>{{ s.instructor_name || s.instructor_id }}</td>
        <td>{{ getLessonTypeLabel(s) }}</td>
        <td>
         <button type="button" class="appt-cta" (click)="onOccupancySlotChosen(s)">
  קבע שיעור מילוי מקום
</button>

        </td>
      </tr>
    </tbody>
  </table>

  <p *ngIf="loadingOccupancySlots">טוען שיעורים למילוי מקום...</p>

  <p class="error" *ngIf="occupancySlotsError">{{ occupancySlotsError }}</p>

  <p
    class="empty-text"
    *ngIf="!loadingOccupancySlots && !occupancySlotsError && occupancySlots.length === 0"
  >
    אין זמינות למילוי מקום בטווח שנבחר.
  </p>
</div>

 <!-- ======== טאב: שיעור השלמה ======== -->
<div *ngIf="selectedTab === 'makeup'" class="appt-card">
  <h3>שיעורים שמחפשים השלמה </h3>

  <!-- רשימת שיעורים שניתן להשלים -->
  <div class="slots-list">

    <ng-container *ngIf="loadingMakeupCandidates">
      <p>טוען שיעורים שניתן להשלים...</p>
    </ng-container>

    <ng-container *ngIf="!loadingMakeupCandidates && makeupCandidates.length > 0">
      <table class="appt-table makeup-table">
        <thead>
          <tr>
            <th>תאריך</th>
            <th>יום</th>
            <th>שעה</th>
            <th>מדריך</th>
            <th></th>
          </tr>
        </thead>

        <tbody>
          <tr
            *ngFor="let c of makeupCandidates"
            [ngClass]="{
              'makeup-row-selected':
                selectedMakeupCandidate?.lesson_id === c.lesson_id &&
                selectedMakeupCandidate?.occur_date === c.occur_date
            }"
          >
            <td>{{ c.occur_date }}</td>
            <td>{{  dayOfWeekLabelFromDate(c.occur_date)  }}</td>
<td>
  <span class="time-range">
    {{ c.start_time | slice:0:5 }}–{{ c.end_time | slice:0:5 }}
  </span>
</td>
            <td>{{ getInstructorNameById(c.instructor_id) }}</td>
            <td>
              <button type="button" class="appt-cta" (click)="openHolesForCandidate(c)">
                להשלמת שיעור זה
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </ng-container>

    <p class="empty-text" *ngIf="!loadingMakeupCandidates && !makeupCandidates.length">
      אין כרגע שיעורים שניתן להשלים.
    </p>

    <p class="error" *ngIf="makeupError">{{ makeupError }}</p>
    <p class="success" *ngIf="makeupCreatedMessage">{{ makeupCreatedMessage }}</p>
  </div>

  <!-- חורים פנויים עבור השיעור שנבחר -->
  <div class="slots-list" *ngIf="selectedMakeupCandidate && candidateSlots.length > 0">
    <h4>חורים פנויים להשלמה עבור {{ selectedMakeupCandidate.occur_date }}</h4>

    <table class="appt-table">
      <thead>
        <tr>
          <th>תאריך</th>
          <th>יום</th>
          <th>שעה</th>
          <th>מדריך</th>
          <th>סוג שיעור</th>
          <th></th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let s of candidateSlots">
          <td>{{ s.occur_date }}</td>
          <td>{{ getSlotDayLabel(s.occur_date) }}</td>
<td>
  <span class="time-range">
    {{ s.start_time | slice:0:5 }}–{{ s.end_time | slice:0:5 }}
  </span>
</td>
          <td>{{ s.instructor_name || s.instructor_id }}</td>
          <td>{{ getLessonTypeLabel(s) }}</td>
          <td>
            <button type="button" class="appt-cta" (click)="onMakeupSlotChosen(s)">
              קבע שיעור השלמה
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <p *ngIf="loadingCandidateSlots">טוען חורים פנויים...</p>
    <p class="error" *ngIf="candidateSlotsError">{{ candidateSlotsError }}</p>
  </div>

  <!-- דיאלוג אישור להורה -->
  <ng-template #confirmMakeupDialog let-dialogRef="dialogRef">
    <div dir="rtl" style="padding: 10px; max-width: 350px;">
      <h3>אישור בקשת שיעור השלמה</h3>

      <p>
        האם את בטוחה שברצונך לבקש שיעור השלמה
        לתאריך <b>{{ confirmData.newDate }}</b>
בשעות <b><span class="time-range">{{ confirmData.newStart | date:'dd-MM-yyyy'}}–{{ confirmData.newEnd | date:'dd-MM-yyyy'}}</span></b>
        במקום השיעור בתאריך
        <b>{{ confirmData.oldDate | date:'dd-MM-yyyy' }}</b>
        בשעות <b>{{ confirmData.oldStart }}–{{ confirmData.oldEnd }}</b>?
        ניתן לבטל שיעור עד {{ hoursBeforeCancel }} שעות לפני מועד השיעור ללא חיוב.
      </p>

      <div style="display:flex; justify-content: flex-end; gap: 8px; margin-top: 20px;">
        <button mat-button (click)="dialogRef.close(false)">ביטול</button>
        <button mat-raised-button color="primary" (click)="dialogRef.close(true)">אישור</button>
      </div>
    </div>
  </ng-template>
</div>

<!-- דיאלוג אישור מילוי מקום -->
<!-- דיאלוג הורה (בקשה למזכירה) -->
<ng-template #confirmOccupancyParentDialog let-dialogRef="dialogRef">
  <div dir="rtl" style="padding: 10px; max-width: 380px;">
    <h3>אישור בקשת מילוי מקום</h3>

    <p>
      האם את בטוחה שברצונך <b>לבקש</b> מילוי מקום
      בתאריך <b>{{ occupancyConfirmData.newDate | date:'dd-MM-yyyy'}}</b>
      בשעות <b>{{ occupancyConfirmData.newStart | date:'dd-MM-yyyy'}}–{{ occupancyConfirmData.newEnd | date:'dd-MM-yyyy'}}</b>
      עם המדריך <b>{{ occupancyConfirmData.newInstructorName }}</b><br>
      במקום השיעור שהיה בתאריך
      <b>{{ occupancyConfirmData.oldDate | date:'dd-MM-yyyy'}}</b>
      בשעות <b>{{ occupancyConfirmData.oldStart }}–{{ occupancyConfirmData.oldEnd }}</b>
      עם המדריך <b>{{ occupancyConfirmData.oldInstructorName }}</b>?
    </p>

    <div style="display:flex; justify-content:flex-end; gap: 8px; margin-top: 20px;">
      <button mat-button (click)="dialogRef.close(false)">ביטול</button>
      <button mat-raised-button color="primary" (click)="dialogRef.close(true)">שליחת בקשה</button>
    </div>
  </div>
</ng-template>

<!-- דיאלוג מזכירה (קביעה בפועל) -->
<ng-template #confirmOccupancySecretaryDialog let-dialogRef="dialogRef">
  <div dir="rtl" style="padding: 10px; max-width: 380px;">
    <h3>אישור קביעת שיעור מילוי מקום</h3>

    <p>
      האם את בטוחה שברצונך <b>לקבוע</b> שיעור מילוי מקום
      בתאריך <b>{{ occupancyConfirmData.newDate }}</b>
      בשעות <b>{{ occupancyConfirmData.newStart }}–{{ occupancyConfirmData.newEnd }}</b>
      עם המדריך <b>{{ occupancyConfirmData.newInstructorName }}</b><br>
      במקום השיעור שהיה בתאריך
      <b>{{ occupancyConfirmData.oldDate }}</b>
      בשעות <b>{{ occupancyConfirmData.oldStart }}–{{ occupancyConfirmData.oldEnd }}</b>
      עם המדריך <b>{{ occupancyConfirmData.oldInstructorName }}</b>?
    </p>

    <div style="display:flex; justify-content:flex-end; gap: 8px; margin-top: 20px;">
      <button mat-button (click)="dialogRef.close(false)">ביטול</button>
      <button mat-raised-button color="primary" (click)="dialogRef.close(true)">אישור קביעה</button>
    </div>
  </div>
</ng-template>
