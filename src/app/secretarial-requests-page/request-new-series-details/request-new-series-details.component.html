<div class="wrap" dir="rtl" *ngIf="request as r">
  <div class="head">
    <div class="title">
      <mat-icon class="ico">repeat</mat-icon>
      ×¤×¨×˜×™ ×‘×§×©×” ×œ×¤×ª×™×—×ª ×¡×“×¨×ª ×©×™×¢×•×¨×™×
    </div>
  </div>

  <div class="card">

    <div class="child-status-alert" *ngIf="childStatusBannerText as t">
      {{ t }}
    </div>

    <div class="row">
      <div class="k">×©× ×™×œ×“/×”</div>
      <div class="v strong">{{ childFullName() }}</div>
    </div>

    <div class="row">
      <div class="k">×ª×´×–</div>
      <div class="v">{{ childGovId() || 'â€”' }}</div>
    </div>

    <div class="row">
      <div class="k">×™×•× ×‘×©×‘×•×¢</div>
      <div class="v">{{ startWeekdayName || 'â€”' }}</div>
    </div>

    <div class="row">
      <div class="k">×ª××¨×™×š ×”×ª×—×œ×”</div>
      <div class="v">{{ startDate || 'â€”' }}</div>
    </div>

    <div class="row" *ngIf="!isOpenEnded">
      <div class="k">×ª××¨×™×š ×¡×™×•×</div>
      <div class="v">{{ endDate || 'â€”' }}</div>
    </div>

    <div class="row">
      <div class="k">××“×¨×™×š/×”</div>
      <div class="v">{{ instructorName() || 'â€”' }}</div>
    </div>

    <div class="row">
      <div class="k">×©×¢×ª ×”×ª×—×œ×” ××‘×•×§×©×ª</div>
      <div class="v">{{ requestedStartTime || 'â€”' }}</div>
    </div>

    <div class="row">
      <div class="k">×¡×•×’ ×¡×“×¨×”</div>
      <div class="v">{{ isOpenEnded ? '×œ×œ× ×”×’×‘×œ×”' : '××•×’×‘×œ×ª' }}</div>
    </div>

    <div class="row" *ngIf="!isOpenEnded">
      <div class="k">××¡×¤×¨ ×©×™×¢×•×¨×™×</div>
      <div class="v">{{ repeatWeeks || 'â€”' }}</div>
    </div>

    <div class="row">
      <div class="k">×¡×•×’ ×©×™×¢×•×¨</div>
      <div class="v">
        {{ ridingTypeName() || 'â€”' }}
        <ng-container *ngIf="lessonTypeMode()">
          â€¢ {{ lessonTypeMode() }}
        </ng-container>
      </div>
    </div>

    <div class="row">
      <div class="k">××¡×œ×•×œ ×ª×©×œ×•×</div>
      <div class="v">{{ paymentPlanName() || 'â€”' }}</div>
    </div>

    <div class="row" *ngIf="isOpenEnded">
      <div class="k">×—×œ×•×Ÿ ×‘×“×™×§×” (×™××™×)</div>
<div class="v">{{ seriesSearchHorizonDays }}</div>
    </div>

    <div class="row">
      <div class="k">×“×™×œ×•×’×™× (×™××™ ×—×•×¤×© ×—×•×•×”)</div>
      <div class="v" *ngIf="skippedFarmDates?.length; else noFarmSkips">
        <ul class="list-inline">
          <li *ngFor="let d of skippedFarmDates">{{ d }}</li>
        </ul>
      </div>
      <ng-template #noFarmSkips>â€”</ng-template>
    </div>

    <div class="row">
      <div class="k">×“×™×œ×•×’×™× (××™-×–××™× ×•×ª ××“×¨×™×š)</div>
      <div class="v" *ngIf="skippedInstructorDates?.length; else noInstructorSkips">
        <ul class="list-inline">
          <li *ngFor="let d of skippedInstructorDates">{{ d }}</li>
        </ul>
      </div>
      <ng-template #noInstructorSkips>â€”</ng-template>
    </div>

    <div class="row">
      <div class="k">×§×•×‘×¥ ×”×¤× ×™×”</div>
      <div class="v">
        <ng-container *ngIf="referralUrl; else noReferral">
          <a [href]="referralUrl" target="_blank" rel="noopener">×¤×ª×™×—×ª ×§×•×‘×¥ ×”×¤× ×™×”</a>
        </ng-container>
        <ng-template #noReferral>â€”</ng-template>
      </div>
    </div>

    <!-- ×©×™×‘×•×¥ ×§×™×™× / ××©×ª×ª×¤×™× -->
    <div class="subcard" *ngIf="existingParticipants().length">

      <div class="row" *ngIf="participantsCapacity() as cap">
        <div class="k">×©×™×‘×•×¥ ×§×™×™×</div>
        <div class="v">{{ cap.current }} / {{ cap.max }}</div>
      </div>

      <div class="mini-box">
        <div class="mini-head">
          <div>×©×</div>
          <div class="c">××™×Ÿ</div>
          <div class="c">×’×™×œ</div>
          <div>×”×¢×¨×•×ª</div>
        </div>

        <div class="mini-row" *ngFor="let c of existingParticipants()">
          <div class="cell">{{ c.first_name }} {{ c.last_name }}</div>
          <div class="cell c">{{ c.gender || 'â€”' }}</div>
          <div class="cell c">{{ calcAge(c.birth_date) }}</div>
          <div class="cell notes-cell">
            <span *ngIf="c.medical_notes">ğŸ©º {{ c.medical_notes }}</span>
            <span *ngIf="c.behavior_notes">âš  {{ c.behavior_notes }}</span>
          </div>
        </div>
      </div>

    </div>

    <div class="meta" *ngIf="req()">
      <div><span class="mk">× ×•×¦×¨:</span> {{ req()!.createdAt | date:'dd/MM/yyyy HH:mm' }}</div>
    </div>

    <textarea
      class="note"
      *ngIf="canDecide()"
      [(ngModel)]="note"
      placeholder="×”×¢×¨×” ×œ××–×›×™×¨×” / ×¡×™×‘×” ×œ×“×—×™×™×” (×—×•×‘×” ×‘×“×—×™×™×”)">
    </textarea>

    <div class="hint error" *ngIf="!note.trim() && !loading() && canDecide()">
      ×—×•×‘×” ×œ××œ× ×¡×™×‘×” ×œ×¤× ×™ ×“×—×™×™×ª ×‘×§×©×”
    </div>

    <div class="actions" *ngIf="canDecide()">
      <button mat-stroked-button type="button" class="action reject"
              (click)="rejectSelected()"
              [disabled]="loading() || !note.trim()">
        ×“×—×™×™×”
      </button>

      <button mat-flat-button type="button" class="action approve"
              (click)="approveSelected()"
              [disabled]="loading() || !canApprove()"
              [matTooltip]="approveTooltip || ''"
              [matTooltipDisabled]="!approveTooltip"
              matTooltipPosition="above">
        ××™×©×•×¨
      </button>
    </div>

  </div>
</div>
