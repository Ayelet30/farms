<div class="activity-summary" dir="rtl">
  <header class="head">
    <h1>סיכום פעילות</h1>
    <div class="actions">
      <button class="btn" (click)="exportCsv()">ייצוא CSV</button>
      <button class="btn primary" (click)="refresh()" [disabled]="loading()">רענון</button>
    </div>
  </header>

  <!-- Filters -->
  <section class="filters">
    <!-- Children picker -->
    <div class="filter-group">
      <label>בחירת ילדים</label>

      <div class="children-picker">
        <button class="chip" (click)="selectAllChildren()">כל הילדים</button>
        <button class="chip outline" (click)="clearChildren()">נקה</button>
      </div>

      <div class="children-list">
        <label *ngFor="let c of children()" class="child-item">
          <input
            type="checkbox"
            [checked]="selectedChildIds().includes(c.child_uuid)"
            (change)="onToggleChild(c, $any($event.target).checked)"

          />
          <span class="dot" [style.background]="c.color || '#8ebf6e'"></span>
          <span>{{ c.full_name }}</span>
        </label>
      </div>
    </div>

    <!-- Date range -->
    <div class="filter-group">
      <label>טווח תאריכים</label>
      <div class="dates">
       <input type="date"
       [ngModel]="dateFrom()"
       (ngModelChange)="dateFrom.set($event)" />

<span class="sep">—</span>

<input type="date"
       [ngModel]="dateTo()"
       (ngModelChange)="dateTo.set($event)" />

      </div>
    </div>
  </section>

  <!-- Table -->
  <section class="table-wrap">
    <table class="summary">
      <thead>
        <tr>
          <th>תאריך</th>
          <th>שעות</th>
          <th>מדריך</th>
          <th>ילד</th>
          <th>הערת מדריך</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngIf="loading()">
          <td colspan="5" class="muted">טוען…</td>
        </tr>
        <tr *ngIf="!loading() && rows().length === 0">
          <td colspan="5" class="muted">אין נתונים לתקופה זו.</td>
        </tr>
        <tr *ngFor="let r of rows()">
          <td>{{ r.date }}</td>
          <td>{{ r.time }}</td>
          <td>{{ r.instructor }}</td>
          <td>{{ r.child }}</td>
          <td class="note">{{ r.note }}</td>
        </tr>
      </tbody>
    </table>
  </section>
</div>
